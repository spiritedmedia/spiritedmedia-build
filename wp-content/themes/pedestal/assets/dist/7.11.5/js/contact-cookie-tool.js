!function(){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){var a=!1;if(function(e){try{var t=window[e],a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(e){return!1}}("localStorage")&&(a=!0),null!=t&&("object"===s(t)&&(t=JSON.stringify(t)),a?localStorage.setItem(e,t):o(e,t,30)),void 0===t){if(a)var r=localStorage.getItem(e);else r=function(e){for(var t=e+"=",a=document.cookie.split(";"),r=0,n=a.length;r<n;r++){for(var o=a[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}(e);try{var n=JSON.parse(r)}catch(e){n=r}return n}function o(e,t,a){var r=new Date;r.setTime(r.getTime()+24*a*60*60*1e3);var n="; expires="+r.toGMTString();document.cookie=e+"="+t+n+"; path=/"}null===t&&(a?localStorage.removeItem(e):o(e,"",-1))}var a,u=function(){function c(){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),this.storageKey="contactData",this.version=4,$(".js-signup-email-form").on("pedFormSubmission:success",function(e,t){"emailAddress"in t&&a.fetchData(t.emailAddress,!1)});var e=localStorageCookie("subscriberData");e&&"data"in e&&(localStorageCookie("subscriberData",""),localStorageCookie(this.storageKey,e));var t=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r={};return t||(t=location.search),t.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,a){r[t]=a}),e?r[e]:r}("mc_eid"),r=localStorageCookie(this.storageKey);if(!(r&&"object"==s(r)&&"data"in r))return this.deleteData(),void this.fetchData(t);if(!("mc_id"in r.data&&"version"in r&&"updated"in r))return this.deleteData(),void this.fetchData(t);var n=r.data.mc_id;if(t&&(n=t),r.version!=this.version)return this.deleteData(),void this.fetchData(n);var o=(new Date).getTime()/1e3,i=new Date(r.updated).getTime()/1e3;if((i+=1209600)<=o)return this.deleteData(),void this.fetchData(n);$(document).on("ready",function(){return a.triggerEvent("ready",r)})}var e,t,a;return e=c,(t=[{key:"deleteData",value:function(){localStorageCookie(this.storageKey,"")}},{key:"fetchData",value:function(e){var t=this,a=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e){var r=this.storageKey,n={action:"get_contact_data",contactID:e};$.post(PedVars.ajaxurl,n,function(e){e.success&&(localStorageCookie(r,e.data),a&&t.triggerEvent("ready",e.data))})}}},{key:"triggerEvent",value:function(e,t){var a="pedContact:"+e;$(document).trigger(a,[t])}}])&&r(e.prototype,t),a&&r(e,a),c}();(a=jQuery).fn.serializeFormJSON=function(){var e={},t=this.serializeArray();return a.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},jQuery(document).ready(function(r){var t=new u,e=c(t.storageKey),n=r("#status");function o(){var e=c(t.storageKey);r("#raw-data-output").text(JSON.stringify(e,null,4))}if(e&&"data"in e)for(var i in n.text("Importing values from cookie"),o(),e.data){var a=e.data[i];switch(s(a)){case"boolean":a=a?"true":"false"}r("#"+i).val(a).change()}r("#target-audiences").on("change",function(){var e=r(this).val(),t={newsletter_subscriber:!0,current_member:!1,donate_365:!1};switch(e){case"unidentified":t.newsletter_subscriber=!1;break;case"contact":break;case"donor":t.donate_365=!0;break;case"member":t.current_member=!0}for(i in t){var a=String(t[i]);r("#"+i).val(a)}r(".the-form input").trigger("change"),n.html("Set cookie to <code>"+e+"</code> target audience")}),r(".the-form").on("change","input, select",function(){var e=r(this),a=e.parents("form").serializeFormJSON();r.each(a,function(e,t){""!==t&&(isNaN(1*t)?"false"!==t&&"true"!==t||(a[e]="true"==t):a[e]=1*t)}),c(t.storageKey,{version:3,updated:(new Date).toISOString(),data:a}),n.html("Updated cookie: <code>"+e.attr("name")+"</code> set to <code>"+e.val()+"</code>"),o()})})}();