!function(){"use strict";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=function(){function e(){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storageKey="subscriberData",this.version=3,$(document).on("ready",function(){var e=localStorageCookie(r.storageKey);e&&"data"in e&&r.triggerEvent("ready",e)}),$(".js-signup-email-form").on("pedFormSubmission:success",function(e,t){return r.listenForEmailSignups(e,t)}),this.maybeRefresh()}var t,r,a;return t=e,(r=[{key:"maybeRefresh",value:function(){var e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a={};return t||(t=location.search),t.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,r){a[t]=r}),e?a[e]:a}("mc_eid"),t=localStorageCookie(this.storageKey);if(t&&"data"in t){var r=!1;if("mc_id"in t.data&&(r=t.data.mc_id),"version"in t&&t.version!=this.version)return this.fetchData(r),!0;if("updated"in t){var a=(new Date).getTime()/1e3,n=new Date(t.updated).getTime()/1e3;if((n+=1209600)<=a)return this.fetchData(r),!0}this.triggerEvent("ready",t)}else if(e)return this.fetchData(e),!0;return!1}},{key:"fetchData",value:function(e){var t=this,r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],a={action:"get_subscriber_data",subscriberID:e},n=this.storageKey;$.post(PedVars.ajaxurl,a,function(e){e.success&&(localStorageCookie(n,e.data),r&&t.triggerEvent("ready",e.data))})}},{key:"listenForEmailSignups",value:function(e,t){"emailAddress"in t&&this.fetchData(t.emailAddress,!1)}},{key:"triggerEvent",value:function(e,t){var r="pedSubscriber:"+e;$(document).trigger(r,[t])}}])&&n(t.prototype,r),a&&n(t,a),e}();jQuery(document).ready(function(o){var e=new t,s=subscriberExpectedMergeFields.data;!function(e,t){var r=!1;if(function(e){try{var t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(e){return!1}}("localStorage")&&(r=!0),null!=t&&("object"===u(t)&&(t=JSON.stringify(t)),r?localStorage.setItem(e,t):i(e,t,30)),void 0===t){if(r)var a=localStorage.getItem(e);else a=function(e){for(var t=e+"=",r=document.cookie.split(";"),a=0,n=r.length;a<n;a++){for(var i=r[a];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}(e);try{var n=JSON.parse(a)}catch(e){n=a}return}function i(e,t,r){var a=new Date;a.setTime(a.getTime()+24*r*60*60*1e3);var n="; expires="+a.toGMTString();document.cookie=e+"="+t+n+"; path=/"}null===t&&(r?localStorage.removeItem(e):i(e,"",-1))}(e.storageKey,null),e.fetchData(subscriberEmail),o(this).on("pedSubscriber:ready",function(e,t){o("#output").html(JSON.stringify(t.data,null,4));var r={pass:[],fail:[]};for(var a in s){var n=t.data[a],i=s[a];n!==i?r.fail.push({key:a,expected:i,actualValue:n}):r.pass.push(a)}r.fail.length<=0?o("#pass").show():(o("#fail").show(),o("#fail-output").html(JSON.stringify(r.fail,null,4))),o.get("?cleanup",function(){})})})}();