"use strict";!function(t){var e={init:function(){this.clusterMap={stories:"pedestal_story",topics:"pedestal_topic",people:"pedestal_person",organizations:"pedestal_org",places:"pedestal_place",localities:"pedestal_locality"},this.connections={entities_to_clusters:{from:"entities",to:["stories","topics","people","organizations","places","localities"]},stories_to_clusters:{from:"stories",to:["topics","people","organizations","places","localities"]}},this.siteURL=window.location.protocol+"//"+window.location.hostname;for(var e in this.connections)this.manageConnectionsMetaboxes(this.connections[e],e);setTimeout(function(){t(".p2p-toggle-tabs a").click().hide()},1500),this.toggleIOTDEmbedField(),this.makeHierarchicalTermsFilterable(),this.setupSummaryButtons(),this.disableDraggingDistributionMetaboxes()},extractDomain:function(t){var e;return(e=t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]).replace("www.",""),e=e.split(":")[0]},manageConnectionsMetaboxes:function(e,i){for(var n,o=e.to,s=o.length-1;s>=0;s--){n=o[s];var a=e.from+"_to_"+n,r=t("[data-p2p_type="+a+"].p2p-box"),c=t("#fm-pedestal_"+i+"_connections-0-"+n+"-0-tab .fm-group-inner");0!==r.length&&0!==c.length&&(c.append(r.parent().html()),r.closest(".postbox").remove())}},toggleIOTDEmbedField:function(){t(".post-type-pedestal_embed #fm-embed_url-0").on("blur",function(e){var i=t(e.target),n=t("#fm_meta_box_daily_insta_date");-1!==i.val().indexOf("instagr")?n.show():n.hide(),fm.datepicker.add_datepicker(e)}).blur()},makeHierarchicalTermsFilterable:function(){var e=t(".categorydiv");if(!(e.length<1)){jQuery.expr[":"].contains=function(t,e,i){var n=(t.textContent||t.innerText||"").toUpperCase(),o=i[3].toUpperCase();return n.indexOf(o)>=0};var i=t('<input type="search" />').addClass("categorydiv-filter").css("width","100%");e.each(function(e,n){var o=t(n);if(!(o.find(".categorychecklist li").length<10)){var s=o.parent().siblings(".hndle").text();i.attr("placeholder","Filter "+s),o.prepend(i)}}),t("#post").on("keyup",".categorydiv-filter",function(){var e=t(this),i=e.parent().find(".categorychecklist li");e.val().length<2?i.show():i.hide().find(".selectit:contains("+e.val()+")").each(function(e,i){t(i).parent().show()})}).on("keydown",".categorydiv-filter",function(t){if(13==t.keyCode)return t.preventDefault(),!1}).on("click",".categorydiv-filter",function(){var e=t(this);setTimeout(function(){e.trigger("keyup")},100,e)})}},setupSummaryButtons:function(){var e="fm-homepage_settings-0-summary-0",i=t(".js-pedestal-summary-copy-subhead"),n=t(".js-pedestal-summary-copy-first-graf");i.on("click",function(){var i=t("textarea#excerpt").val();""!==i&&tinyMCE.get(e).setContent(i)}),n.on("click",function(){var i=tinyMCE.get("content").getContent(),n=t(i).filter("p").not(function(){var t=/\[([^\s\]]+)([^\]]+)?\]([^[]*)?(\[\/(\S+?)\])?/;return this.innerHTML.match(t)});if(!(0>=n.length)){var o=n.first().html();tinyMCE.get(e).setContent(o)}})},disableDraggingDistributionMetaboxes:function(){var e=t("#distribution-sortables");e.sortable({disabled:!0}),e.find(".postbox .hndle").css("cursor","pointer")}};t(document).ready(function(){e.init()})}(jQuery);