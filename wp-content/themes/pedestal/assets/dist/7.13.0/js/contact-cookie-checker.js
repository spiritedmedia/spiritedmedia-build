!function(){"use strict";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var t=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataStorageKey="contactData",this.historyStorageKey="contactHistory",this.adblockerStorageKey="contactAdblocker",this.version=4,this.contactData(),this.contactHistory()}var e,a,o;return e=t,(a=[{key:"contactData",value:function(){var a=this;$(".js-signup-email-form").on("pedFormSubmission:success",function(t,e){"emailAddress"in e&&a.fetchData(e.emailAddress,!1)});var t=localStorageCookie("subscriberData");t&&"data"in t&&(localStorageCookie("subscriberData",""),localStorageCookie(this.dataStorageKey,t));var e=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",o={};return e||(e=location.search),e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,a){o[e]=a}),t?o[t]:o}("mc_eid"),o=localStorageCookie(this.dataStorageKey);if(!(o&&"object"==c(o)&&"data"in o))return this.deleteData(),void this.fetchData(e);if(!("mc_id"in o.data&&"version"in o&&"updated"in o))return this.deleteData(),void this.fetchData(e);var r=o.data.mc_id;if(e&&(r=e),o.version!=this.version)return this.deleteData(),void this.fetchData(r);var n=(new Date).getTime()/1e3,i=new Date(o.updated).getTime()/1e3;if((i+=1209600)<=n)return this.deleteData(),void this.fetchData(r);$(document).on("ready",function(){return a.triggerEvent("ready",o)})}},{key:"contactHistory",value:function(){var t=localStorageCookie(this.historyStorageKey);t&&Array.isArray(t)||(t=[]),t.unshift({t:Date.now(),u:window.location.pathname});var e=new Date;e.setDate(e.getDate()-30),t=t.filter(function(t){return t.t>e.getTime()}),localStorageCookie(this.historyStorageKey,t)}},{key:"isFrequentReader",value:function(){var t=localStorageCookie(this.historyStorageKey);if(t&&6<=t.filter(function(t){return"/20"===t.u.slice(0,3)}).length)return!0;return!1}},{key:"deleteData",value:function(){localStorageCookie(this.dataStorageKey,"")}},{key:"fetchData",value:function(t){var e=this,a=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(t){var o=this.dataStorageKey,r={action:"get_contact_data",contactID:t};$.post(PedVars.ajaxurl,r,function(t){t.success&&(localStorageCookie(o,t.data),a&&e.triggerEvent("ready",t.data))})}}},{key:"triggerEvent",value:function(t,e){var a="pedContact:"+t;$(document).trigger(a,[e])}},{key:"adblocker",set:function(t){var e="boolean"==typeof t?t:null;localStorageCookie(this.adblockerStorageKey,e)}}])&&r(e.prototype,a),o&&r(e,o),t}());!function(t,e){var a=!1;if(function(t){try{var e=window[t],a="__storage_test__";return e.setItem(a,a),e.removeItem(a),!0}catch(t){return!1}}("localStorage")&&(a=!0),null!=e&&("object"===c(e)&&(e=JSON.stringify(e)),a?localStorage.setItem(t,e):n(t,e,30)),void 0===e){if(a)var o=localStorage.getItem(t);else o=function(t){for(var e=t+"=",a=document.cookie.split(";"),o=0,r=a.length;o<r;o++){for(var n=a[o];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null}(t);try{var r=JSON.parse(o)}catch(t){r=o}return}function n(t,e,a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3);var r="; expires="+o.toGMTString();document.cookie=t+"="+e+r+"; path=/"}null===e&&(a?localStorage.removeItem(t):n(t,"",-1))}("contactData",""),jQuery(document).ready(function(i){var c=contactExpectedMergeFields.data;t.fetchData(contactEmail),i(document).on("pedContact:ready",function(t,e){i("#output").html(JSON.stringify(e.data,null,4));var a={pass:[],fail:[]};for(var o in c)if("since"!=o){var r=e.data[o],n=c[o];r!==n?a.fail.push({key:o,expected:n,actualValue:r}):a.pass.push(o)}else a.pass.push(o);a.fail.length<=0?i("#pass").show():(i("#fail").show(),i("#fail-output").html(JSON.stringify(a.fail,null,4))),i.get("?cleanup",function(){})})})}();