{% import _self as nav_macros %}

{% macro secondary_nav_list( data ) %}
    <ul class="site-nav__list">
        {% for class, item in data %}
            <li class="site-nav__item">
                <a href="{{ item.url|esc_url }}" class="site-nav__link {{ class|esc_attr }}">
                    {% if item.icon %}
                        {{ ped_icon( item.icon, 'site-nav__icon' ) }}
                    {% endif %}
                    {{ item.title }}
                </a>
            </li>
        {% endfor %}
    </ul>
{% endmacro %}

<header class="site-header--with-nav" role="banner">
    <div class="site-header--with-nav__inner">
        <a
            href="{{ site_url|esc_url }}"
            class="site-header--with-nav__logo-link"
            rel="home"
            data-ga-category="Site Logo|Header"
            data-ga-label=""
        >
            {{ ped_logo( 'logo', 'site-header--with-nav__logo' ) }}
            <span class="invisible">Home</span>
        </a>

        <a
            href="{{ site_url|esc_url }}/navigation/"
            class="site-header--with-nav__menu-trigger js-modal-trigger"
            data-modal-target="#site-header--with-nav-modal-menu"
        >
            {{ ped_icon( 'bars', 'site-header--with-nav__hamburger' ) }}
            <span class="invisible">Menu</span>
        </a>

        <form
            method="get"
            action="{{ site_url|esc_url }}"
            id="site-header-search-modal"
            class="search-form--sitewide site-header--with-nav__search-modal"
        >

            <label class="form-label u-text-color-white" for="site-header--search-field">Search {{ domain_name }}</label>
            <div class="search-form__input-group input-group-v2">
                {{ ped_icon( 'search', 'input-group-v2__addon' ) }}
                <input
                    type="search"
                    name="s"
                    id="site-header--search-field"
                    class="input-group-v2__input form-input js-site-header--search-field"
                    placeholder="enter your search term"
                    value="{{ search_query|esc_attr }}"
                >
            </div>
            <button class="search-form__button btn-v2--oval--light site-header--with-nav__search-button">Search</button>
        </form>

        <section
            id="site-header--with-nav-modal-menu"
            class="site-header--with-nav__modal-menu"
        >
            <div class="site-nav--primary__outer">
                <nav class="site-nav site-nav--primary">
                    <ul class="site-nav__list">
                        {% for item in primary_nav %}

                            {% if item.slug == 'search' %}
                                {% set additional_classes = 'js-modal-trigger' %}
                                {% set additional_attributes = 'data-modal-target="#site-header-search-modal"' %}
                            {% endif %}

                            <li class="site-nav__item">
                                <a
                                    href="{{ item.url|esc_url }}"
                                    class="site-nav__link {{ additional_classes|esc_attr }}"
                                    {{ additional_attributes }}

                                >
                                    <div class="site-nav__group">
                                        {% if item.icon %}
                                            {{ ped_icon( item.icon, 'site-nav__icon' ) }}
                                        {% endif %}
                                        <span class="site-nav__text--{{ item.slug|esc_attr }}">
                                            {{ item.title }}
                                        </span>
                                    </div>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </nav>
            </div>

            {% if secondary_nav_mobile %}
                {% set secondary_nav_desktop_class = 'site-nav--desktop' %}
                <nav class="site-nav--secondary site-nav--mobile" aria-hidden="true">
                    {{ nav_macros.secondary_nav_list( secondary_nav_mobile ) }}
                </nav>
            {% endif %}

            <nav class="site-nav--secondary {{ secondary_nav_desktop_class|esc_attr }}">
                {{ nav_macros.secondary_nav_list( secondary_nav ) }}
            </nav>

            <div class="site-header--with-nav__marketing">
                <ul class="site-header--with-nav__social">
                    {% set gaCategorySocial = 'Social Icon - Header' %}
                    {% set socialIconClass = 'site-header--with-nav__social-icon' %}

                    <li class="site-header--with-nav__social-item">
                        <a
                            href="{{ twitter_url|esc_url }}"
                            target="_blank"
                            class="site-header--with-nav__social-link"
                            data-ga-category="{{ gaCategorySocial|esc_attr }}"
                            data-ga-label="Twitter"
                        >
                            {{ ped_icon('twitter', socialIconClass) }}
                        </a>
                    </li>
                    <li class="site-header--with-nav__social-item">
                        <a
                            href="{{ facebook_url|esc_url }}"
                            target="_blank"
                            class="site-header--with-nav__social-link"
                            data-ga-category="{{ gaCategorySocial|esc_attr }}"
                            data-ga-label="Facebook"
                        >
                            {{ ped_icon('facebook', socialIconClass) }}
                        </a>
                    </li>
                    <li class="site-header--with-nav__social-item">
                        <a
                            href="{{ instagram_url|esc_url }}"
                            target="_blank"
                            class="site-header--with-nav__social-link"
                            data-ga-category="{{ gaCategorySocial|esc_attr }}"
                            data-ga-label="Instagram"
                        >
                            {{ ped_icon('instagram', socialIconClass) }}
                        </a>
                    </li>
                </ul>

                {% if tagline %}
                <p class="site-header--with-nav__tagline">{{ tagline }}</p>
                {% endif %}
            </div>
        </section>
    </div>
</header>
